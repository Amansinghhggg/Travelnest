<% layout('layouts/boilerplate') %>
<link rel="stylesheet" href="/css/editlisting.css">

<div class="edit-listing-container">
  <div class="page-header">
    <h1><i class="fa-solid fa-pen-to-square"></i> Edit Listing</h1>
    <p>Update your property information</p>
  </div>
  
  <div class="listing-form-card">
    <form action="/listings/<%= listing._id %>?_method=PUT" method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
      
      <div class="form-group">
        <label for="title">
          <i class="fa-solid fa-heading"></i> Property Title
        </label>
        <input type="text" id="title" name="title" value="<%= listing.title %>" 
               placeholder="e.g., Luxury Penthouse with City Views, Cozy Mountain Cabin" 
               required>
        <div class="invalid-feedback">Please enter a valid title</div>
      </div>
      
      <div class="form-group">
        <label for="description">
          <i class="fa-solid fa-align-left"></i> Description
        </label>
        <textarea id="description" name="description" 
                  placeholder="Tell guests what makes your place special... amenities like WiFi, kitchen, pool, nearby attractions, perfect for families/couples, etc." 
                  required><%= listing.description %></textarea>
        <div class="invalid-feedback">Please enter a valid description</div>
      </div>
      
      <div class="form-group">
        <label>
          <i class="fa-solid fa-image"></i> Current Image
        </label>
        <div class="current-image-preview">
          <img src="<%= previewImageUrl %>" alt="Current Listing Image">
        </div>
      </div>
      
      <div class="form-group">
        <label>
          <i class="fa-solid fa-cloud-arrow-up"></i> Upload New Image (Optional)
        </label>
        <div class="file-upload-wrapper">
          <input type="file" id="image" name="Listing[image]" accept="image/*">
          <div class="file-upload-icon">
            <i class="fa-solid fa-arrows-rotate"></i>
          </div>
          <div class="file-upload-text">
            <strong>Click to upload new image</strong> or drag and drop<br>
            <small>Leave empty to keep current image</small>
          </div>
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="price">
            <i class="fa-solid fa-indian-rupee-sign"></i> Price per Night
          </label>
          <input type="number" id="price" name="price" value="<%= listing.price %>" 
                 placeholder="3500" min="1" required>
          <div class="invalid-feedback">Please enter a valid price</div>
        </div>
        
        <div class="form-group">
          <label for="country">
            <i class="fa-solid fa-globe"></i> Country
          </label>
          <input type="text" id="country" name="country" value="<%= listing.country %>" 
                 placeholder="e.g., India, Maldives, Nepal" required>
          <div class="invalid-feedback">Please enter a valid country</div>
        </div>
      </div>
      
      <div class="form-group">
        <label for="location">
          <i class="fa-solid fa-location-dot"></i> Location / Address
        </label>
        <input type="text" id="location" name="location" value="<%= listing.location %>" 
               placeholder="e.g., Udaipur Lakeside, Delhi NCR, Shimla Mall Road" required>
        <div class="invalid-feedback">Please enter a valid location</div>
      </div>
      
      <div class="form-actions">
        <button type="submit" class="btn-update">
          <i class="fa-solid fa-check"></i> Update Listing
        </button>
        <a href="/listings/<%= listing._id %>" class="btn-cancel">
          <i class="fa-solid fa-xmark"></i> Cancel
        </a>
      </div>
      
    </form>
  </div>
</div>